package rules

import com.sbnz.crcalculator.facts.Monster;
import com.sbnz.crcalculator.service.ChallengeRatingService;

global ChallengeRatingService challengeRatingService;

rule "Determine challenge rating"

    when
        $m: Monster($d: defensiveChallengeRating != null, $o: offensiveChallengeRating != null)
    then
    	System.out.println("Determine challenge rating fired");
    	Integer ordinal = (Integer)(($d.getOrdinal() + $o.getOrdinal())/2);
        modify ($m) { setChallengeRating(challengeRatingService.findByOrdinal(ordinal))};

end